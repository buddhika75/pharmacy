<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:h="http://xmlns.jcp.org/jsf/html">

    <body>

        <ui:composition template="./resources/template/template.xhtml">

            <ui:define name="content">

                <p:panel >
                    <p:panel >
                        <p>Upload a xls file with following columns.
                            <ul>
                                <li>1. Item Name</li>
                                <li>2. Item Code</li>
                                <li>3. Generic Name</li>
                            </ul>
                        </p>
                    </p:panel>
                </p:panel>
                <p:panel >
                    <h:form enctype="multipart/form-data">
                        <p:fileUpload value="#{pharmacyItemExcelManager.file}" mode="simple"/>
                        <h:commandButton value="Submit" action="#{pharmacyItemExcelManager.detectMismatch}"/>
                    </h:form>
                </p:panel>
                <h:form>
                    <p:tabView >
                        <p:tab title="Missing Items" >
                            <p:commandButton value="Excel" ajax="false" >
                                <p:dataExporter target="tblNoItems" fileName="Items not in the system" type="xls" ></p:dataExporter>
                            </p:commandButton>
                            <p:dataTable id="tblNoItems" value="#{pharmacyItemExcelManager.itemNotPresent}" var="inp" >
                                <p:column >
                                    <h:outputLabel value="#{inp}" ></h:outputLabel>
                                </p:column>
                            </p:dataTable>
                        </p:tab>
                        <p:tab title="Different Codes" >
                            <p:commandButton value="Excel" ajax="false">
                                <p:dataExporter target="tblNoItems" fileName="Codes differ" type="xls" ></p:dataExporter>
                            </p:commandButton>
                            <p:dataTable value="#{pharmacyItemExcelManager.itemsWithDifferentCode}" var="inc" >
                                <p:column >
                                    <h:outputLabel value="#{inc}" ></h:outputLabel>
                                </p:column>
                            </p:dataTable>
                        </p:tab>
                        <p:tab title="Different Generic Name" >
                            <p:commandButton value="Excel" ajax="false">
                                <p:dataExporter target="tblNoItems" fileName="Generic Name differ" type="xls" ></p:dataExporter>
                            </p:commandButton>
                            <p:dataTable value="#{pharmacyItemExcelManager.itemsWithDifferentGenericName}" var="ing" >
                                <p:column >
                                    <h:outputLabel value="#{ing}" ></h:outputLabel>
                                </p:column>
                            </p:dataTable>

                        </p:tab>
                    </p:tabView>
                </h:form> 
            </ui:define>

        </ui:composition>

    </body>
</html>
